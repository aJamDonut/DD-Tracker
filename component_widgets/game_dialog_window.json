{
    "name": "Dialog Window",
    "codename": "game_dialog_window",
    "value": "0",
    "quantity": "0",
    "credits_shop_item": "0",
    "type": "component_widgets",
    "color": "#202327",
    "editedtime": null,
    "vars": {
        "getElement": "function(ops) {\r\n\r\n    if(!ops) {\r\n        ops = {\r\n            dialog: _BLUEPRINTS.DIALOGS['dialog_recruit_npc'],\r\n            options: {callerObject: new LifeObject({dialog: 'dialog_recruit_npc'})}\r\n        }\r\n    }\r\n\r\n    var dialog = ops.dialog;\r\n    var options = ops.options;\r\n\r\n    var xOffset = 35;\r\n    var yOffset = 60;\r\n\r\n    var w = 700;\r\n    var h = 320;\r\n\r\n    var x = (game.ui._VIEWPORT_RIGHT \/ 2) - (w \/ 2);\r\n    var y = (game.ui._VIEWPORT_BOTTOM \/ 2) - (h \/ 2);\r\n\r\n    var pane = game.render.componentRaw('drawBoxPane', { name: 'test', callerObject: options.callerObject, title: 'Dialog', x: 0, y: 0, w: w, h: h });\r\n    pane.x = x;\r\n    pane.y = y;\r\n\r\n    var picContainer = game.render.componentRaw('drawBoxPane', { name: 'test', callerObject: options.callerObject, x: 0, y: 0, w: w - 10, h: 140 });\r\n    picContainer.y += yOffset - 30;\r\n    picContainer.x = 5\r\n    pane.addChild(picContainer)\r\n\r\n    console.error(\"Clone this fool\");\r\n    console.log(options.callerObject);\r\n    var npcPic = options.callerObject.cloneForUI();\r\n    pane.addChild(npcPic);\r\n    npcPic.showNameTag();\r\n    npcPic.x = xOffset - 7.5;\r\n    npcPic.y = yOffset - 3;\r\n\r\n    xOffset += 75;\r\n\r\n    var finalY = 0;\r\n\r\n    lblName = game.render.text('' + dialog.dialog + '', 'dialog-main');\r\n\r\n    pane.addChild(lblName);\r\n    lblName.x = xOffset;\r\n    lblName.y = yOffset;\r\n    opt1 = game.render.text('1. ' + dialog.option1, 'dialog-main');\r\n\r\n    pane.addChild(opt1);\r\n    opt1.pane = pane;\r\n    opt1.x = xOffset;\r\n    opt1.y = lblName.y + 120;\r\n    opt1.origX = opt1.x;\r\n    opt1.isInteractive();\r\n    opt1.options = options;\r\n    opt1.pic = npcPic;\r\n    opt1.dialogObject = dialog;\r\n    opt1.runFunc = dialog.option1_func;\r\n    opt1.dialog = options.dialog;\r\n    opt1.callerObject = options.callerObject;\r\n\r\n    finalY = opt1.y;\r\n\r\n    opt1.on('pointerover', function () {\r\n        this.x += 5;\r\n    })\r\n\r\n    opt1.on('pointerout', function () {\r\n        this.x = this.origX;\r\n    })\r\n\r\n    opt1.on('pointerup', function () {\r\n        this.pic.destroy();\r\n        this.pane.destroy();\r\n\r\n\r\n        var response = this.dialogObject.option1_func(this.callerObject, game.p);\r\n        if (typeof response == \"string\") {\r\n            var goBack = function () {\r\n                game.render.component('game_dialog', { dialog: this.callerDialog, callerObject: this.callerObject }, 'game_dialog');\r\n            };\r\n            game.render.component('game_dialog_window', { dialog: { dialog: response, callerObject: this.callerObject, callerDialog: this.dialog, option1: 'Go back', option1_func: goBack }, options: this.options }, 'game_dialog');\r\n        }\r\n    })\r\n\r\n    if (dialog.option2) {\r\n        opt2 = game.render.text('2. ' + dialog.option2, 'dialog-main');\r\n\r\n        pane.addChild(opt2);\r\n        opt2.x = xOffset;\r\n        opt2.y = opt1.y + 30;\r\n        opt2.pic = npcPic;\r\n        finalY = opt2.y;\r\n        opt2.callerObject = options.callerObject;\r\n        opt2.origX = opt1.x;\r\n        opt2.isInteractive();\r\n        opt2.pane = pane;\r\n        opt2.options = options;\r\n        opt2.dialogObject = dialog;\r\n        opt2.runFunc = dialog.option1_func;\r\n        opt2.dialog = options.dialog;\r\n\r\n        opt2.on('pointerover', function () {\r\n            this.x += 5;\r\n        })\r\n\r\n        opt2.on('pointerout', function () {\r\n            this.x = this.origX;\r\n        })\r\n\r\n        opt2.on('pointerup', function () {\r\n            this.pic.destroy();\r\n            this.pane.destroy();\r\n            var response = this.dialogObject.option2_func(this.callerObject, game.p);\r\n            if (typeof response == \"string\") {\r\n                var goBack = function () {\r\n                    game.render.component('game_dialog', { dialog: this.callerDialog, callerObject: this.callerObject }, 'game_dialog');\r\n                };\r\n                game.render.component('game_dialog_window', { dialog: { dialog: response, callerObject: this.callerObject, callerDialog: this.dialog, option1: 'Go back', option1_func: goBack }, options: this.options }, 'game_dialog');\r\n            }\r\n        })\r\n    }\r\n\r\n    if (dialog.option3) {\r\n        opt3 = game.render.text('3. ' + dialog.option3, 'dialog-main');\r\n\r\n        pane.addChild(opt3);\r\n        opt3.x = xOffset;\r\n        opt3.y = opt2.y + 30;\r\n        opt3.callerObject = options.callerObject;\r\n        opt3.origX = opt1.x;\r\n        opt3.pic = npcPic;\r\n        finalY = opt3.y;\r\n        opt3.isInteractive();\r\n        opt3.pane = pane;\r\n        opt3.options = options;\r\n        opt3.dialogObject = dialog;\r\n        opt3.runFunc = dialog.option1_func;\r\n        opt3.dialog = options.dialog;\r\n\r\n        opt3.on('pointerover', function () {\r\n            this.x += 5;\r\n        })\r\n\r\n        opt3.on('pointerout', function () {\r\n            this.x = this.origX;\r\n        })\r\n\r\n        opt3.on('pointerup', function () {\r\n            this.pic.destroy();\r\n            this.pane.destroy();\r\n            var response = this.dialogObject.option3_func(this.callerObject, game.p);\r\n            if (typeof response == \"string\") {\r\n                var goBack = function () {\r\n                    game.render.component('game_dialog', { dialog: this.callerDialog, callerObject: this.callerObject }, 'game_dialog');\r\n                };\r\n                game.render.component('game_dialog_window', { dialog: { dialog: response, callerObject: this.callerObject, callerDialog: this.dialog, option1: 'Go back', option1_func: goBack }, options: this.options }, 'game_dialog');\r\n            }\r\n        })\r\n    }\r\n\r\n    opt3 = game.render.text('X. Leave', 'item-gold');\r\n\r\n    pane.addChild(opt3);\r\n    opt3.x = xOffset;\r\n    opt3.y = finalY + 30;\r\n    opt3.callerObject = options.callerObject;\r\n    opt3.origX = opt1.x;\r\n    opt3.pic = npcPic;\r\n    opt3.isInteractive();\r\n    opt3.pane = pane;\r\n    opt3.options = options;\r\n    opt3.dialogObject = dialog;\r\n    opt3.runFunc = dialog.option1_func;\r\n    opt3.dialog = options.dialog;\r\n\r\n    opt3.on('pointerover', function () {\r\n        this.x += 5;\r\n    })\r\n\r\n    opt3.on('pointerout', function () {\r\n        this.x = this.origX;\r\n    })\r\n\r\n    opt3.on('pointerup', function () {\r\n        this.pic.destroy();\r\n        this.pane.destroy();\r\n    })\r\n\r\n\r\n    game.render.aboveAll.addChild(pane);\r\n    return pane;\r\n}"
    }
}